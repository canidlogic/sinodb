# Sino database datasets

This directory contains additional datasets.  These are supplements to the externally defined TCOFL, COCT, and CC-CEDICT datasets.  The configuration file must reference this directory and the files must have the exact names they are given here (see `config.md` in the `doc` directory).

To generate the files, you first need to build the Sino database using empty files for `blocklist.txt` `extradfn.txt` and `level9.txt`.  You then build the dataset files from that version of the database, as described in the sections below.  Finally, delete the Sino database that was generated and rebuild using the generated dataset files to get the full version.

## Level 9 supplement

The file `level9.txt` contains the "level 9 supplement."  It was generated by first building a Sino database with empty dataset files, as described earlier.  Then, the `xrefwords.pl` script is run on this version of the database, and the output of that script is the `level9.txt` file that is given in this directory.

This dataset is a plain-text file in UTF-8 format where there is one traditional Han rendering per line.  Each of these lines represents headwords that are neither in the TOCFL nor the COCT datasets, but which are referenced either directly or indirectly by measure-words/classifiers, cross-references, or citations in CC-CEDICT records relating to words in the TOCFL and COCT datasets.

This supplement is necessary so that all references within the subset of the CC-CEDICT dictionary present within the Sino database can be resolved.  You can use the `xrefwords.pl` script to check this; it should return no headwords when run on a Sino database that was generated including the `level9.txt` headwords.

All words in this supplement are given a wordlevel of 9 when they are entered into the Sino database, to indicate that they are neither in TOCFL nor COCT.

## Blocklist

The file `blocklist.txt` contains traditional Han readings that should _not_ be included in the Sino database, even if they are present in TOCFL or COCT.  The file `blocklist.txt` is a concatenation of `blocklist_16.txt` and `blocklist_79.txt`.  Blocked words are words that do not have any corresponding entry in CC-CEDICT, and so they are not included in the Sino database since they lack definition.

The vast majority of words on the blocklist are from levels 7 and 8.  (The level 9 supplement when it was generated automatically suppresses words not in CC-CEDICT, so there shouldn't be any blocked words in level 9.)  The file `blocklist_79.txt` includes all the blocked words from levels 7 through 9.  It was generated by first creating a Sino database with empty dataset files as described earlier, and then running the following:

    report/nogloss.pl -level 7-9 -redir -han > blocklist_79.txt

Words below level 7 were manually reviewed.  First, a temporary list was generated of potentially blocked words from levels 1-6 by running the following:

    report/nogloss.pl -level 1-6 -redir -han > TEMP.txt

This generated 30 candidate headwords for possible inclusion in the blocklist.  Each of these candidates were manually reviewed.  Of them, only 6 were actually included in `blocklist_16.txt`.  The other 26 were identified from an alternate dictionary source on Wiktionary.  The Wiktionary definitions were then adapted and reformatted as supplemental CC-CEDICT entries (see next section) and stored in `extradfn.txt`.

The full `blocklist.txt` is a UTF-8 plain-text file with one headword per line.  Any TOCFL or COCT record where _all_ Han renderings are on the blocklist should be skipped and not added to the Sino database.

## Dictionary supplement

The file `extradfn.txt` contains extra records that are added in by the `Sino::Dict` parser at the end of each iteration, as if they were part of the main CC-CEDICT file.  As such, this file is in the same format as CC-CEDICT.  The words on this list were derived from the candidate blocklist for levels 1-6, as explained in the previous section.  The definitions were adapted from Wiktionary, and the pronunciations were verified from both Wiktionary and the pronunciations of the individual characters in CC-CEDICT.

Whenever Han traditional characters in CC-CEDICT are shown with a simplified equivalent, those substitutions are used to derive the simplified forms given in the supplement.  The traditional forms match missing words in TOCFL and COCT.  Note that in a number of cases, the traditional forms given here use a mixture of traditional and simplified characters according to CC-CEDICT, even though the forms are exactly as they appear in the TOCFL and COCT datasets.
